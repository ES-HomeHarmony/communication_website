"use strict";(self.webpackChunkmicrosite=self.webpackChunkmicrosite||[]).push([[8649],{7194:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>t});var s=i(4848),a=i(8453);const o={sidebar_position:10},l="Notification Service",r={id:"notification",title:"Notification Service",description:"Kafka Email Notification Service",source:"@site/docs/notification.md",sourceDirName:".",slug:"/notification",permalink:"/communication_website/docs/notification",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_position:10},sidebar:"tutorialSidebar",previous:{title:"Frontend",permalink:"/communication_website/docs/houses/Frontend"},next:{title:"Web APP Interface",permalink:"/communication_website/docs/web-app_interface"}},d={},t=[{value:"Kafka Email Notification Service",id:"kafka-email-notification-service",level:2},{value:"Funcionalidades",id:"funcionalidades",level:2},{value:"1. Kafka Consumer",id:"1-kafka-consumer",level:3},{value:"2. Personaliza\xe7\xe3o de E-mails",id:"2-personaliza\xe7\xe3o-de-e-mails",level:3},{value:"3. Envio de E-mails",id:"3-envio-de-e-mails",level:3},{value:"4. Gerenciamento de Threads",id:"4-gerenciamento-de-threads",level:3},{value:"Exemplos de Mensagens",id:"exemplos-de-mensagens",level:2},{value:"Kafka Message: Convite de Usu\xe1rio",id:"kafka-message-convite-de-usu\xe1rio",level:3},{value:"Features",id:"features",level:2},{value:"1. Kafka Consumer",id:"1-kafka-consumer-1",level:3},{value:"2. Email Personalization",id:"2-email-personalization",level:3},{value:"3. Email Sending",id:"3-email-sending",level:3},{value:"4. Thread Management",id:"4-thread-management",level:3},{value:"Message Examples",id:"message-examples",level:2},{value:"Kafka Message: User Invitation",id:"kafka-message-user-invitation",level:3},{value:"Kafka Message: Upload de Contrato",id:"kafka-message-upload-de-contrato",level:3},{value:"Kafka Message: Despesa Criada",id:"kafka-message-despesa-criada",level:3},{value:"Kafka Message: Nova Issue",id:"kafka-message-nova-issue",level:3},{value:"Kafka Message: Pagamento de Inquilino",id:"kafka-message-pagamento-de-inquilino",level:3},{value:"Detalhes Adicionais",id:"detalhes-adicionais",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"notification-service",children:"Notification Service"})}),"\n",(0,s.jsx)(n.h2,{id:"kafka-email-notification-service",children:"Kafka Email Notification Service"}),"\n",(0,s.jsx)(n.p,{children:"Esta se\xe7\xe3o descreve a implementa\xe7\xe3o de um servi\xe7o de notifica\xe7\xe3o por e-mail baseado em Kafka. O servi\xe7o escuta t\xf3picos espec\xedficos no Kafka, processa mensagens recebidas e envia notifica\xe7\xf5es por e-mail personalizadas utilizando templates HTML pr\xe9-definidos."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"funcionalidades",children:"Funcionalidades"}),"\n",(0,s.jsx)(n.h3,{id:"1-kafka-consumer",children:"1. Kafka Consumer"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Descri\xe7\xe3o"}),": Escuta mensagens no t\xf3pico ",(0,s.jsx)(n.code,{children:"invite-request"})," e outros relacionados a eventos no sistema."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Funcionalidade"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Processa eventos como:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cria\xe7\xe3o de usu\xe1rio"}),": Envia um e-mail de boas-vindas para o usu\xe1rio convidado."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Envio de contrato"}),": Notifica o usu\xe1rio sobre o upload de um contrato."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Despesa criada"}),": Informa os usu\xe1rios sobre uma nova despesa associada a uma casa."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Nova issue"}),": Notifica os usu\xe1rios sobre problemas reportados."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Pagamento de inquilino"}),": Confirma o pagamento recebido de um inquilino."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Desserializa mensagens no formato JSON para processamento."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"2-personaliza\xe7\xe3o-de-e-mails",children:"2. Personaliza\xe7\xe3o de E-mails"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Descri\xe7\xe3o"}),": Personaliza dinamicamente os templates de e-mail com base nos dados recebidos via Kafka."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Implementa\xe7\xe3o"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Carrega templates HTML da pasta ",(0,s.jsx)(n.code,{children:"templates"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Substitui placeholders (como ",(0,s.jsx)(n.code,{children:"{{name}}"}),", ",(0,s.jsx)(n.code,{children:"{{house_name}}"}),", etc.) com dados espec\xedficos contidos nas mensagens."]}),"\n",(0,s.jsxs)(n.li,{children:["Suporta m\xfaltiplos templates para diferentes tipos de notifica\xe7\xf5es:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"invite.html"}),": Para convites de usu\xe1rio."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"contract.html"}),": Para notifica\xe7\xf5es de upload de contrato."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"expense.html"}),": Para notifica\xe7\xf5es de cria\xe7\xe3o de despesas."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"issue.html"}),": Para notifica\xe7\xf5es de issues criadas."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"tenant_payment.html"}),": Para notifica\xe7\xf5es de pagamento de inquilino."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"3-envio-de-e-mails",children:"3. Envio de E-mails"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Descri\xe7\xe3o"}),": Gerencia o envio de e-mails utilizando o protocolo SMTP."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Funcionalidade"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Recupera as configura\xe7\xf5es SMTP das vari\xe1veis de ambiente."}),"\n",(0,s.jsx)(n.li,{children:"Conecta-se ao servidor SMTP, autentica e envia o e-mail."}),"\n",(0,s.jsx)(n.li,{children:"Garante seguran\xe7a utilizando TLS durante a transmiss\xe3o."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"4-gerenciamento-de-threads",children:"4. Gerenciamento de Threads"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Descri\xe7\xe3o"}),": Executa o consumidor Kafka em uma thread separada para evitar bloqueios na aplica\xe7\xe3o principal."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Execu\xe7\xe3o"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["A thread \xe9 inicializada no evento de inicializa\xe7\xe3o da aplica\xe7\xe3o (",(0,s.jsx)(n.code,{children:'@app.on_event("startup")'}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"exemplos-de-mensagens",children:"Exemplos de Mensagens"}),"\n",(0,s.jsx)(n.h3,{id:"kafka-message-convite-de-usu\xe1rio",children:"Kafka Message: Convite de Usu\xe1rio"}),"\n",(0,s.jsx)(n.h1,{id:"notifications",children:"Notifications"}),"\n",(0,s.jsx)(n.h1,{id:"kafka-email-notification-service-1",children:"Kafka Email Notification Service"}),"\n",(0,s.jsx)(n.p,{children:"This section describes the implementation of a Kafka-based email notification service. The service listens to specific Kafka topics, processes incoming messages, and sends personalized email notifications using predefined HTML templates."}),"\n",(0,s.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,s.jsx)(n.h3,{id:"1-kafka-consumer-1",children:"1. Kafka Consumer"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Description"}),": Listens to messages on the ",(0,s.jsx)(n.code,{children:"invite-request"})," topic."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Functionality"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Processes events such as:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"User Invitations"}),": Sends an invitation email to the specified user."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Deserializes messages in JSON format for processing."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-email-personalization",children:"2. Email Personalization"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Description"}),": Dynamically customizes email templates based on the message type."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Implementation"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Loads HTML templates from the ",(0,s.jsx)(n.code,{children:"templates"})," directory."]}),"\n",(0,s.jsxs)(n.li,{children:["Substitutes placeholders (e.g., ",(0,s.jsx)(n.code,{children:"{{name}}"}),", ",(0,s.jsx)(n.code,{children:"{{house_name}}"}),") with data provided in Kafka messages."]}),"\n",(0,s.jsxs)(n.li,{children:["Supports multiple templates for different notification types:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"invite.html"}),": For user invitations."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-email-sending",children:"3. Email Sending"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Description"}),": Handles the sending of emails using the SMTP protocol."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Functionality"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Retrieves SMTP configuration from environment variables."}),"\n",(0,s.jsx)(n.li,{children:"Connects to the SMTP server, authenticates, and sends the email."}),"\n",(0,s.jsx)(n.li,{children:"Ensures security by using TLS for email transmission."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"4-thread-management",children:"4. Thread Management"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Description"}),": Runs the Kafka consumer in a separate thread to avoid blocking the main application."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Execution"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The thread is initialized during the application startup (",(0,s.jsx)(n.code,{children:'@app.on_event("startup")'}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"message-examples",children:"Message Examples"}),"\n",(0,s.jsx)(n.h3,{id:"kafka-message-user-invitation",children:"Kafka Message: User Invitation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "action": "create_user",\n  "user_data": {\n    "name": "John Doe",\n    "email": "john.doe@example.com"\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"kafka-message-upload-de-contrato",children:"Kafka Message: Upload de Contrato"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "action": "upload_contract",\n  "user_data": {\n    "name": "Jane Smith",\n    "email": "jane.smith@example.com"\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"kafka-message-despesa-criada",children:"Kafka Message: Despesa Criada"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "action": "expense_created",\n  "expense_details": {\n    "title": "Aluguel Mensal",\n    "amount": 1200.00,\n    "description": "Aluguel referente ao m\xeas de janeiro.",\n    "deadline_date": "2025-01-15"\n  },\n  "users": [\n    {\n      "name": "John Doe",\n      "email": "john.doe@example.com"\n    },\n    {\n      "name": "Jane Smith",\n      "email": "jane.smith@example.com"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"kafka-message-nova-issue",children:"Kafka Message: Nova Issue"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "action": "new_issue",\n  "issue": {\n    "title": "Conserto de encanamento",\n    "description": "Vazamento no banheiro",\n    "status": "Aberto",\n    "priority": "Alta"\n  },\n  "house_name": "Resid\xeancia Central",\n  "tenant_name": "Carlos Silva",\n  "users": [\n    {\n      "name": "John Doe",\n      "email": "john.doe@example.com"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"kafka-message-pagamento-de-inquilino",children:"Kafka Message: Pagamento de Inquilino"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "action": "tenant_paid",\n  "name": "Maria Oliveira",\n  "email": "maria.oliveira@example.com",\n  "tenant_name": "Carlos Silva",\n  "expense_name": "Aluguel Mensal",\n  "amount": 1200.00,\n  "house_name": "Resid\xeancia Central"\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"detalhes-adicionais",children:"Detalhes Adicionais"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Diret\xf3rio de Templates"}),": Todos os templates HTML s\xe3o armazenados no diret\xf3rio ",(0,s.jsx)(n.code,{children:"templates"}),". Certifique-se de que os arquivos de template correspondam aos placeholders esperados no c\xf3digo."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Vari\xe1veis de Ambiente"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"KAFKA_BOOTSTRAP_SERVERS"}),": Endere\xe7o dos servidores Kafka."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"SMTP_HOST"}),": Endere\xe7o do servidor SMTP."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"SMTP_PORT"}),": Porta do servidor SMTP."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"SMTP_USER"}),": Usu\xe1rio para autentica\xe7\xe3o SMTP."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"SMTP_PASS"}),": Senha para autentica\xe7\xe3o SMTP."]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>r});var s=i(6540);const a={},o=s.createContext(a);function l(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);